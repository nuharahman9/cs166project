# SQL Hotel Management System 
<img width="556" alt="Screenshot 2024-03-07 at 11 22 58 PM" src="https://github.com/nuharahman9/sql-hotelManagement/assets/72107811/e17a7a77-96f3-479d-8b99-f46ea60cd3d1">

For our project, we prioritized making the functions more user friendly. We added error handling wherever possible so the user can try inputting their information again. We also added 2 triggers to handle timestamps and dates.
1. viewHotels (Nuha) takes latitude and longitude inputs from the user. The first issue was calling the sql function in a query. We found after some experimenting that we can call the query in the select clause, as well as the where clause. If the user does not input a number, a user-friendly error message is thrown. The function outputs "hotels near you", with the hotel ID, hotel name, and the units away from the given latitude and longitude.
2. viewRooms (William) takes the hotelID and the date in format (YYYY-MM-DD) from the user. If the user formats the date incorrectly, the program handles the error by telling the user the proper date format and sends the user to the main menu where they can try again. The same happens when the user inputs an invalid hotelID. We ran into a problem where the LEFT JOIN with Rooms and roomBookings was outputting an extra row. We initially tried: "select * from Rooms left join roomBookings using (roomNumber, hotelID) where Rooms.hotelID = 1 and RoomBookings.bookingDate = '2015-05-12';" (with testing from the interactive environment) but it only returned one row. This is because we were filtering out all rows after the join. We found that the following query works with outputting availability: "select Rooms.price, Rooms.roomNumber, case when RoomBookings.bookingDate = '2015-05-12' then 'unavailable' else 'available' end as availability from Rooms left join roomBookings on roomBookings.roomNumber = Rooms.roomNumber and Rooms.hotelID = RoomBookings.hotelID and RoomBookings.bookingDate = '2015-05-12' where Rooms.hotelID = 1 order by Rooms.roomNumber;" since we are only joining the roomBookings rows with the user-inputted date.
3. bookRooms (Nuha) takes the hotelID and roomNumber from the user to confirm that the hotel and room exists in the database. It then takes the date of the stay to ensure the date format is correct. I wrote the query so that it takes the three inputs and finds the room in question. It tells the user whether the room is unavailable and returns the user to the main menu. If the room is available, it inserts the information into roomBookings and confirms the booking is successful along with the price of the room.
4. viewRecentBookingsfromCustomer (Nuha) does not take any user input. Instead, the query shows the bookingDate, roomNumber, and price of the Room, which are then
ordered by bookingDate in descending order. If the user doesn’t have a history the
function prints “You appear to not have any bookings!” and returns to the main menu.
5. updateRoomInfo (William) takes a hotelID, roomNumber and runs a query to confirm
that they are in the database. The function then opens to another menu where the user can select either Room Price or Room ImageURL. By selecting either of these, the function prompts the user for the new information and updates Room tables with it. This information is then inserted into roomUpdatesLog along with the roomupdate_trigger logging the current timestamp when it happens.
6. viewRecentUpdates (William) takes the userID and outputs the latest 5 rows from RoomUpdatesLog matching the userID. An error message is thrown and the user is redirected if the user is not a manager.
7. viewBookingHistoryOfHotel (William) takes the hotel id, as well as a start and end booking date and returns all the bookings in that date range. We were stuck on this query for a while, but realized we could use BETWEEN to compute the range of dates. Error messages are thrown if the user does not enter valid dates, or if the manager enters a hotel id for a hotel that they are not in charge of.
8. viewRegularCustomers (Nuha) takes a hotel id and from the input line and outputs the user ids, user names, and the number of bookings that they have made, and is ordered by the customer with the most bookings. If the manager enters a hotel they are not in charge of, an error message is thrown.
9. placeRoomRepairRequests (Nuha): takes a hotel id, room number, company id and inserts the values accordingly into RoomRepairs and RoomRepairRequests. The date trigger is used here to automatically generate a date. Error messages are thrown for invalid hotel ids, company ids, and room numbers. We ran into the problem of making sure that the repairID is the same for RoomRepairs and RoomRepairRequests, but found a way around it by extracting the latest insert from RoomRepairs and then parsed the repairID for the RoomRepairRequests insert.
10. viewRoomRepairHistory (Nuha): takes no user input. It instead runs a query that outputs the companyID, hotelID, roomNumber, and repairDate from the RoomRepairs table for any repairs at the hot
Additional Functions in Java:
1. We added isManager(esql, authorisedUser) to check if the current user is a manager. 2. We added isValidDate(esql, authorisedUser) to check if the date entered is valid.
